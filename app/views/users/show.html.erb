<div>
  <!-- USER INFO -->
  <% if user_signed_in? && current_user.photo.attached? %>
    <%= cl_image_tag current_user.photo.key %>
  <% end %>
  <h1><%= @user.first_name %> <%= @user.last_name %></h1>
  <h2><%= @user.profile %></h2>
  <p><%= @user.email %></p>
</div>

<!-- ACCEPTED BOOKINGS <-->
<div class="games-container">
  <h2>Your Upcoming Games</h2>
  <div class="items">
    <% @user.bookings.each do |booking| %>
      <div class="card" style="width: 24rem;">
        <div class="card-body">
          <% if booking.status == "accepted" %>
            <h5 class="card-title"> <%= booking.game.team.name %></h5>
            <p class="card-text"><%= booking.game.address %></p>
            <p class="card-text"><%= booking.game.date %></p>
            <p class="profile-button"><%= link_to "View game details", game_path(booking.game) %></p>
          <% else %>
            <h5 class="card-title">You dont have any current bookings</h5>
            <p class="card-text">Go check out all available games to find one that works for you!</p>
            <p><%= link_to "View all games", games_path %></p>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>


<!-- BOOKINGS FROM OTHER USERS -->
<div class="requests-container">
  <h2>Requests to join your games</h2>
  <div class="items">
    <% @user.requested_bookings.each do |booking| %>
      <div class="card" style="width: 24rem;">
        <div class="card-body">
          <p><%= booking.user.first_name %> would like to join your team <%= booking.game.team.name %> on <%= booking.game.date %></p>
          <p>Current status: <%= booking.status %></p>
          <%= link_to "Accept", booking_path(booking, booking: {status: "accepted"}), method: :patch  %>
          <%= link_to "Reject", booking_path(booking, booking: {status: "rejected"}), method: :patch  %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<!-- USER TEAMS -->
<div class="teams-container">
  <h2>Your Teams</h2>
    <div class="items">
      <% current_user.teams.each do |team|%>
        <div class="card" style="width: 24rem;">
          <div class="card-body">
            <p><%= team.name %></p>
            <p><%= link_to "Team Page", team_path(team) %></p>
            <li><%= link_to "Create a game for this team", new_team_game_path(team) %> </li>
          </div>
        </div>
      <% end %>
    </div>
  </div>

<!-- USER CREATED GAMES -->
<div class="games-container">
  <h2>Your Ringr Search - upcoming games</h2>
    <div class="items">
      <%current_user.teams.each do |team|%>
        <div class="card" style="width: 24rem;">
          <div class="card-body">
            <% team.games.each do |game|%>
            <p><%= game.address%> @ <%= game.time %></p>
            <li><%= link_to "See game info", game_path(game) %></li>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
</div>

<h2>Unsuccessful Booking Requests</h2>
<div class="card" style="width: 24rem;">
  <div class="card-body">
      <% @user.bookings.each do |booking| %>
        <% if booking.status == "rejected" %>
          <h5 class="card-title"> <%= booking.game.team.name %></h5>
          <p class="card-text"><%= booking.game.address %></p>
          <p class="card-text">Unfortunately your request was not accepted. Please search other games that might suit you!</p>
          <p class="btn"><%= link_to "View all games", games_path %></p>
        <% else %>
          <h5 class="card-title">You dont have any current bookings</h5>
          <p class="card-text">Go check out all available games to find one that works for you!</p>
          <p class="btn"><%= link_to "View all games", games_path %></p>
          <% end %>
        <% end %>
  </div>
</div>
